(function () {
	'use strict';

	// Lightweight DOMPurify shim (extracted). This is a minimal sanitizer
	// to preserve safety if the full DOMPurify library isn't used. For best
	// results replace this file with the official dompurify.min.js build.

	function sanitize(input, cfg) {
		if (typeof input !== 'string') return input;
		try {
			const doc = new DOMParser().parseFromString('<div>' + input + '</div>', 'text/html');
			// Remove dangerous elements
			const blocked = doc.querySelectorAll('script, style, iframe, object, embed');
			blocked.forEach(n => n.remove());

			// Remove inline event handlers and javascript: URIs
			const walker = doc.createTreeWalker(doc.body, NodeFilter.SHOW_ELEMENT, null, false);
			let node;
			while (node = walker.nextNode()) {
				for (const attr of Array.from(node.attributes)) {
					if (/^on/i.test(attr.name)) node.removeAttribute(attr.name);
					if (/^javascript:/i.test(attr.value)) node.removeAttribute(attr.name);
				}
			}

			const out = doc.body.innerHTML;
			if (cfg && cfg.RETURN_TRUSTED_TYPE) return out;
			return out;
		} catch (e) {
			return input;
		}
	}

	var DOMPurify = {
		sanitize: sanitize,
		setConfig: function () {},
		addHook: function () {},
		removeHook: function () {}
	};

	if (typeof window !== 'undefined') window.DOMPurify = DOMPurify;
	else if (typeof self !== 'undefined') self.DOMPurify = DOMPurify;
})();
